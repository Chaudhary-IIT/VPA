<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Users Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/dashboard.css">
</head>

<body>
    <div id="main">
        <nav class="navbar navbar-expand-lg text-white bg-dark bg-gradient p-3 ">
            <div class="container-fluid">
                <a class="navbar-brand text-light" href="/dashboard/admin">Welcome Admin</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav mx-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link text-light" href="/dashboard/admin">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-light" href="/user_details">Users</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-light  btn " href="/search_users">Search</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-light" href="/admin_summary">Summary</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-light" href="/login">Log out</a>
                        </li>
                    </ul>
                    <form class="d-flex" role="search">
                        <a href="/edit-details/{{admin.id}}" class="btn btn-outline-primary" style="color: aliceblue;"
                            id="edit">Edit Profile</a>
                    </form>
                </div>
            </div>
        </nav>
        </div>
        <div id="canvas">
            <nav class="navbar bg-body-dark">
                <div class="container-fluid">
                    <form class="d-flex flex-fill p-2" action="/search_result">
                        <input class="form-control me-2 " type="search" placeholder="Search" aria-label="Search"
                            name="search">
                        <select class="form-select me-2 text-center text-light" style="background-color: rgb(66, 62, 62);" aria-label="Default select example" name="key">
                            <option selected value="user">User</option>
                            <option value="parking_lot">Parking Lot</option>
                        </select>
                        <input class="btn btn-outline-success" type="submit" value="Search">
                    </form>
                </div>
            </nav>            
            <div id="first-one">
                <h1 class="text-center text-light">Results for "{{word}}"</h1>
                {%if key=='user'%}
                {%if result%}
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">ID</th>
                            <th scope="col">Email</th>
                            <th scope="col">Full Name</th>
                            <th scope="col">Date of Birth</th>
                            <th scope="col">Address</th>
                        </tr>
                    </thead>
                    <tbody>
                        {%for user in result%}
                        <tr>
                            <th scope="row">{{loop.index}}</th>
                            <td>{{user.email}}</td>
                            <td>{{user.name}}</td>
                            <td>{{user.dob or '-'}}</td>
                            <td>{{user.address or '-'}}</td>
                        </tr>
                        {%endfor%}
                        </tr>
                    </tbody>
                </table>
                {%else%}
                    <h4 style="color: rgb(248, 70, 70); text-align: center;" class="mx-2">No User Found !!</h4>
                {%endif%}
                {%else%}
                {%if result%}
                <div class="d-flex justify-content-evenly text-center">
                <div class="row ">
                    {%for parking in result%}
                    <div class="col-md-6 mb-4">
                        <div class="card text-white bg-dark bg-gradient p-3 ms-5">
                            <h4>{{loop.index}}. {{parking.location_name}}</h4>
                            <p>{{parking.address}}</p>
                            <div class="d-grid gap-2 d-md-block">
                                <a class="btn btn-outline-warning" href="/edit_lot/{{parking.id}}"
                                    role="button">Edit</a>
                                <a class="btn btn-outline-danger" href="/delete_lot/{{parking.id}}"
                                    role="button">Delete</a>
                            </div>
                            <p class="text-success text-center">
                                (Occupied: {{ parking.spots | selectattr('status', 'equalto', 'O') | list | length }}/{{
                                parking.max_spots }})
                            </p>
                            <div class="container">
                                <div class="row justify-content-center">
                                    {% for spot in parking.spots %}
                                    <div class="text-center mb-2" style="max-width: 50px;">
                                        <div class="border rounded 
                    {% if spot.status == 'O' %}
                        bg-danger text-white
                    {% else %}
                        bg-success text-white
                    {% endif %}
                    " style="width: 30px; height: 30px;">
                                            <a href="/view_spot/{{spot.id}}" class="text-light">{{ spot.status }}</a>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>

                        </div>
                    </div>
                    {%endfor%}
                </div>
            </div>
            {%else%}
                <h4 style="color: rgb(248, 70, 70); text-align: center;" class="mx-2">No Parking Lot Found for this Location !!</h4>
            {%endif%}
            {%endif%}
            </div>
        </div>
    </div>
</body>


</html>